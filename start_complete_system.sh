#!/bin/bash

echo "======================================================"
echo "ðŸ­ MARWAN HUB FACTORIES - Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒØ§Ù…Ù„ v3.2.0"
echo "======================================================"

# ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø®ÙˆØ§Ø¯Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
echo "ðŸ§¹ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø®ÙˆØ§Ø¯Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©..."
pkill -f "python3" 2>/dev/null
sleep 2

# Ø¥Ù†Ø´Ø§Ø¡ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª
echo "ðŸ“ Ø¥Ù†Ø´Ø§Ø¡ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª..."
mkdir -p products/{education,creative,technology,corporate}
mkdir -p exports
mkdir -p downloads

# Ù†Ø³Ø® Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©
echo "ðŸ“¦ Ù†Ø³Ø® Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©..."
cp -n export_system.py products/ 2>/dev/null || true

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
echo "ðŸš€ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…..."
python3 unified_server_enhanced.py &
SERVER_PID=$!

sleep 3

echo ""
echo "âœ… Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­! (PID: $SERVER_PID)"
echo ""
echo "ðŸŽ¯ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:"
echo "   1. ðŸ­ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ§Ù†Ø¹ Ø§Ù„Ø°ÙƒÙŠØ©"
echo "   2. ðŸ“‹ Ù†Ø¸Ø§Ù… Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ù†ØªØ§Ø¬"
echo "   3. ðŸ§ª Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø©"
echo "   4. ðŸ“Š Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø­ÙŠØ©"
echo "   5. ðŸ“¦ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµØ¯ÙŠØ± ÙˆØ§Ù„ØªÙ†Ø²ÙŠÙ„"
echo ""
echo "ðŸŒ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:"
echo "   â€¢ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…:      http://localhost:8000/dashboard_live.html"
echo "   â€¢ Ù…Ø±ÙƒØ² Ø§Ù„ØªÙ†Ø²ÙŠÙ„:     http://localhost:8000/download_products.html"
echo "   â€¢ Ø±ÙØ¹ Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯:    http://localhost:8000/upload_product.html"
echo "   â€¢ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: http://localhost:8000/"
echo ""
echo "ðŸ“Š ÙˆØ§Ø¬Ù‡Ø§Øª API:"
echo "   â€¢ Ø§Ù„Ù…ØµØ§Ù†Ø¹:          http://localhost:8000/api/factories"
echo "   â€¢ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:         http://localhost:8000/api/export/products"
echo "   â€¢ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØµØ­Ø©:     http://localhost:8000/api/health"
echo ""

# Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹
echo "ðŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹ Ù„Ù„Ù†Ø¸Ø§Ù…..."
curl -s http://localhost:8000/api/health | python3 -c "
import sys, json
try:
    data = json.load(sys.stdin)
    print('âœ… API ÙŠØ¹Ù…Ù„:', data.get('status', 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'))
    print('ðŸ“¦ Ø§Ù„Ø¥ØµØ¯Ø§Ø±:', data.get('version', 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'))
    print('âœ¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:', ', '.join(data.get('features', [])))
except:
    print('âš ï¸ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...')
" 2>/dev/null || echo "âš ï¸ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..."

echo ""
echo "======================================================"
echo "ðŸŽ‰ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒØ§Ù…Ù„ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…Ù„!"
echo ""
echo "ðŸ“‹ Ù„Ù„Ø¨Ø¯Ø¡:"
echo "   1. Ø§ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…ØµØ§Ù†Ø¹"
echo "   2. Ø§Ø³ØªØ®Ø¯Ù… Ù†Ø¸Ø§Ù… Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†ØªØ¬Ø§Øª"
echo "   3. Ø§Ù†ØªÙ‚Ù„ Ù„Ù…Ø±ÙƒØ² Ø§Ù„ØªÙ†Ø²ÙŠÙ„ Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©"
echo "======================================================"

# ÙØªØ­ Ø§Ù„Ù…ØªØµÙØ­
echo ""
echo "ðŸŒ ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­..."
termux-open-url "http://localhost:8000/download_products.html" 2>/dev/null

echo ""
echo "Press Ctrl+C to stop the system"
echo "======================================================"

wait
